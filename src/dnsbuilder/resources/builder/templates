{
    "bind": {
        "recursor": {
            "user": "root",
            "command": "named -g -c /usr/local/etc/named.conf",
            "volumes": [
                "resource:/configs/bind/recursor.conf:/usr/local/etc/named.conf:rw",
                "resource:/configs/bind/recursor.conf.options:/usr/local/etc/named.conf.options:rw",
                "resource:/images/controls/bind:/usr/local/var/bind:rw"
            ]
        },
        "auth": {
            "command": "named -g -c /usr/local/etc/named.conf",
            "volumes": [
                "resource:/configs/bind_auth_base.conf:/usr/local/etc/named.conf:rw"
            ]
        },
        "forwarder": {
            "command": "named -g -c /usr/local/etc/named.conf",
            "volumes": [
                "resource:/configs/bind_forwarder_base.conf:/usr/local/etc/named.conf:rw"
            ]
        }
    },
    "unbound": {
        "recursor": {
            "command": "unbound -d",
            "volumes": [
                "resource:/configs/unbound_recursor_base.conf:/usr/local/etc/unbound/unbound.conf",
                "resource:/images/controls/unbound:/usr/local/var/unbound:rw"
            ]
        },
        "forwarder": {
            "command": "unbound -d",
            "volumes": [    
                "resource:/configs/unbound_forwarder_base.conf:/usr/local/etc/unbound/unbound.conf"
            ]
        }
    },
    "monitor": {
        "influxdb": {
            "build": false,
            "image": "tutum/influxdb",
            "ports": [
                "8083:8083",
                "8086:8086"
            ],
            "volumes": [
                "${origin}./${name}/contents:/data"
            ]
        },
        "cadvisor": {
            "build": false,
            "image": "google/cadvisor",
            "ports": [
                "8080:8080"
            ],
            "volumes": [
                "/:/rootfs:ro",
                "/var/run:/var/run:rw",
                "/sys:/sys:ro",
                "/var/lib/docker/:/var/lib/docker:ro"
            ]
        },
        "grafana": {
            "build": false,
            "image": "grafana/grafana",
            "user": "104",
            "ports": [
                "3000:3000"
            ],
            "volumes": [
                "${origin}./${name}/contents:/var/lib/grafana"
            ]
        },
        "traffic": {
            "cap_add": [
                "NET_ADMIN",
                "NET_RAW"
            ],
            "network_mode": "host",
            "address": "",
            "environment": {
                "ENABLE_PROMETHEUS_EXPORTER": "true",
                "INET": "${project.inet}",
                "FILTER": "udp and port 53",
                "ANAME": "${required}",
                "ATTACKER": "${services.${environment.ANAME}.ip}",
                "RNAME": "${required}",
                "RECURSOR": "${services.${environment.RNAME}.ip}",
                "SOFTWARE": "${services.${environment.RNAME}.image.software}"
            },
            "volumes": [
                "resource:/scripts/sh/pcap.sh:/usr/local/etc/pcap.sh",
                "resource:/scripts/configs/supervisord.conf:/usr/local/etc/supervisord.conf",
                "${origin}./${name}/contents:/usr/local/etc",
                "resource:/scripts/py/trace.py:/usr/local/etc/trace.py",
                "resource:/scripts/py/${environment.SOFTWARE}.py:/usr/local/etc/${environment.SOFTWARE}.py",
                "resource:/scripts/py/stat.py:/usr/local/etc/stat.py",
                "resource:/images/controls/${environment.SOFTWARE}:/usr/local/var/${environment.SOFTWARE}:rw"
            ],
            "command": [
                "bash",
                "/usr/local/etc/pcap.sh"
            ],
            "expose": [
                "53",
                "9153"
            ]
        }
    }
}